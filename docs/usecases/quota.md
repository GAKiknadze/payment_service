# QuotaAppService

Управление квотами и лимитами. Доступ для пользователей и администраторов.

## CheckQuotaUsage
**Назначение**: Проверка возможности использования ресурса.

**Доступ**: Все пользователи (через API-вызовы системы).

**Входные параметры**:

- `organizationId`: Идентификатор организации.
- `resourceType`: Тип ресурса.
- `usageIncrement`: Запрашиваемое увеличение (например, 1 токен).

**Условия выполнения**:

- Для ресурсов с квотами: `CurrentQuotaUsage + usageIncrement <= Quota.Limit`.
- Для разовых ресурсов (например, SSL): `usageIncrement <= RemainingQuota`.

**Выходные данные**:

- `isAllowed`: Разрешено ли использование (`true/false`).
- `remainingQuota`: Оставшийся лимит.

**Возможные ошибки**:

- `QuotaExceededException`: Превышение лимита.

---

## IncrementUsage
**Назначение**: Увеличение использования квоты при выполнении операции.

**Доступ**: Системные процессы (автоматически при использовании ресурса).

**Входные параметры**:

- `organizationId`: Идентификатор организации.
- `resourceType`: Тип ресурса.
- `increment`: Значение для увеличения.

**Условия выполнения**:

- Должна существовать активная подписка с этим ресурсом.
- `increment > 0`.

**Постусловия**:

- Обновление `CurrentQuotaUsage` в агрегате `Subscription`.

**Возможные ошибки**:

- `InvalidIncrementException`: Отрицательное или нулевое значение.

**Выходные данные**:

- `newUsage`: Обновленное значение использования квоты.
